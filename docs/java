document.addEventListener("DOMContentLoaded", () => {

    const mapContainer = document.getElementById('map-container');  // Map area
    const addWaypointButton = document.getElementById('add-waypoint');

    // Add waypoint to the map
    addWaypointButton.addEventListener('click', () => {
        const waypointName = prompt("Enter waypoint ICAO Code:");
        if (waypointName) {
            createWaypointOnMap(waypointName);
        }
    });

    // Function to create a waypoint on the map
    function createWaypointOnMap(name) {
        const waypointMarker = document.createElement('div');
        waypointMarker.classList.add('waypoint-marker');
        waypointMarker.textContent = name;
        mapContainer.appendChild(waypointMarker);

        // Add click event for waypoint options
        waypointMarker.addEventListener('click', () => {
            showWaypointOptions(waypointMarker);
        });
    }

    // Show options to Rename or Delete the waypoint
    function showWaypointOptions(marker) {
        // Remove any existing option menu
        removeExistingOptions();

        const optionsMenu = document.createElement('div');
        optionsMenu.classList.add('waypoint-options');
        optionsMenu.innerHTML = `
            <button class="rename-btn">Rename</button>
            <button class="delete-btn">Delete</button>
        `;
        marker.appendChild(optionsMenu);

        // Handle Rename
        optionsMenu.querySelector('.rename-btn').addEventListener('click', () => {
            const newName = prompt("Enter new waypoint name:", marker.textContent.trim());
            if (newName) {
                marker.textContent = newName;
                marker.appendChild(optionsMenu);  // Reattach options after renaming
            }
        });

        // Handle Delete
        optionsMenu.querySelector('.delete-btn').addEventListener('click', () => {
            marker.remove();  // Remove marker from map
        });
    }

    // Remove any open options menu
    function removeExistingOptions() {
        const existingMenus = document.querySelectorAll('.waypoint-options');
        existingMenus.forEach(menu => menu.remove());
    }
});


